# Global Signal Tower Ultimate (全星系信号塔增强版)

这是为《戴森球计划》(Dyson Sphere Program) 开发的一款 BepInEx 模组。它旨在全面强化信号塔、战场基站以及炮塔的性能，通过高性能的全局敌人哈希系统，实现全星球乃至全星系的防御覆盖。

## 🌟 主要功能

### 1. 信号塔全面强化
- **超远电力传输**：大幅提升信号塔的电力连接距离和覆盖半径。
- **全方位信号覆盖**：地面信号范围和太空信号范围获得质的飞跃，轻松覆盖整个星球及周边太空。

### 2. 战场基站增强
- **高效自动化**：大幅提升战场基站的物品拾取范围和建筑建造/维修范围，显著提高战场清理和扩张效率。

### 3. 炮塔性能突破
- **超视距打击**：大幅增加炮塔（如高斯炮、电浆炮）的攻击范围。
- **电浆炮专项增强**：
  - **智能搜索算法**：优化电浆炮的目标搜索逻辑，能够更精准地锁定太空目标。
  - **弹药性能提升**：根据攻击范围自动优化弹道速度和子弹寿命，确保超远距离打击的有效性。

### 4. 全局敌人标记系统 (高性能)
- **跨星球感知**：通过专门设计的 `GlobalEnemyHashSystem`，模组能够高效地管理和标记全星系内的敌人。
- **性能优化**：
  - 采用分级哈希定位逻辑。
  - 支持多线程优化选项（内层锁与外层锁切换）。
  - 低频刷新逻辑，确保在大规模战斗下依然保持游戏流畅。

---

## ⚙️ 配置参数

你可以通过以下几种方式修改模组参数：

### 1. 使用 GUI 界面修改 (推荐)
安装 [BepInEx.ConfigurationManager](https://github.com/BepInEx/BepInEx.ConfigurationManager) 插件。在游戏中按下 `F1` 键，即可在弹出的界面中实时调整各项数值，大部分参数调整后会立即生效。

### 2. 修改配置文件
1. 运行一次游戏以生成配置文件。
2. 打开游戏根目录下的 `BepInEx\config\com.myself.globalsignaltower.cfg` 文件。
3. 使用记事本修改对应数值后保存，并重启游戏。

### 参数对照表

| 配置项 | 默认值 | 描述 |
| :--- | :--- | :--- |
| **信号塔 - 电力连接距离** | 60 | 信号塔之间的连线长度 |
| **信号塔 - 电力覆盖半径** | 60 | 信号塔周围的供电范围 |
| **信号塔 - 地面信号范围** | 600 | 信号塔对地面敌人的探测半径 |
| **信号塔 - 太空信号范围** | 7000 | 信号塔对太空敌人的探测半径 |
| **战场基站 - 拾取范围** | 600 | 自动拾取掉落物的范围 |
| **战场基站 - 建造范围** | 600 | 自动维修和建造的范围 |
| **炮塔增强 - 通用攻击范围**| 100,000 | 所有炮塔的基础打击距离 |
| **开关 - 启用全局标记** | True | 是否允许跨区域标记敌人 |
| **开关 - 启用电浆炮增强** | True | 是否开启电浆炮搜索补丁 |
| **性能优化 - 标记逻辑锁模式**| False | 切换循环内外锁，False 性能更高，True 兼容性更好 |

---

## 🛠️ 安装方法

1. 安装 [BepInEx](https://github.com/BepInEx/BepInEx)。
2. 将编译好的 `MyGlobalSignalTower.dll` 放入游戏根目录下的 `BepInEx\plugins` 文件夹内。
3. 启动游戏，模组将自动加载。

---

## 📝 开发者说明

该项目使用了 HarmonyLib 进行 IL 指令集的 Transpiler 注入，针对关键的射击和搜索逻辑进行了深度优化。

- **核心类**: `GlobalSignalTowerMod`
- **目标框架**: .NET Framework 4.7.2
- **依赖库**: `0Harmony.dll`, `BepInEx.dll`, `UnityEngine.dll`

---

## 🤝 贡献与反馈

如果你在运行过程中遇到任何问题，或者有新的功能建议，欢迎联系开发者。

> **彦祖专属提醒**: 代码中已根据你的要求集成了高性能哈希系统，每个星球每帧只运行一次标记逻辑，确保全宇宙星球兼容性。
